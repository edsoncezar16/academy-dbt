version: 2

sources:
  - name: indicium-ae-certification # aqui você deve substituir pelo nome do dataset criado pela ferramenta de ingestão no bigquery
    schema: sap_adw
    description: Essa é a fonte de dados do nosso ERP
    tables:
      - name: customer
        description: Essa é a tabela de clientes do ERP.
        columns:
          - name: customerid
            description: Essa é a chave primária da tabela fonte de clientes.
            tests:
              - unique
              - not_null
          
          - name: personid
            description: Essa é a chave estrangeira da tabela fonte de clientes para a tabela fonte de pessoas.
            tests:
              - relationships:
                 field: businessentityid
                 to: source('indicium-ae-certification', 'person')

      - name: person
        description: Essa é a tabela de pessoas do ERP.
        columns:
          - name: businessentityid
            description: Essa é a chave primária da tabela fonte de pessoas.
            tests:
              - unique
              - not_null
      
      - name: salesreason
        description: Essa é a tabela de motivo de vendas do ERP.
        columns:
          - name: salesreasonid
            description: Essa é a chave primária da tabela fonte de motivo de vendas.
            tests:
              - unique
              - not_null

      - name: stateprovince
        description: Essa é a tabela de estados do ERP.
        columns:
          - name: stateprovinceid
            description: Essa é a chave primária da tabela fonte de estados.
            tests:
              - unique
              - not_null

      - name: address
        description: Essa é a tabela de endereços do ERP.
        columns:
          - name: addressid
            description: Essa é a chave primária da tabela fonte de endereços.
            tests:
              - unique
              - not_null

      - name: countryregion
        description: Essa é a tabela de países do ERP.
        columns:
          - name: countryregioncode
            description: Essa é a chave primária da tabela fonte de países.
            tests:
              - unique
              - not_null