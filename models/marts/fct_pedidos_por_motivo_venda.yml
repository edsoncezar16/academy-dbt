version: 2
 
models:
 - name: fct_pedidos_por_motivo_venda
   columns:
     - name: localidade_fk
       description: A chave estrengeira para a dimensão de localidade.
       tests:
         - relationships:
               to: ref('dim_localidade')
               field: 'sk_localidade'
    
     - name: cliente_fk
       description: A chave estrengeira para a dimensão de clientes.
       tests:
         - relationships:
               to: ref('dim_cliente')
               field: 'sk_cliente'
    
     - name: produto_fk
       description: A chave estrengeira para a dimensão de produto.
       tests:
         - relationships:
               to: ref('dim_produto')
               field: 'sk_produto'
    
     - name: tipo_cartao_fk
       description: A chave estrengeira para a dimensão de tipo de cartao.
       tests:
         - relationships:
               to: ref('dim_tipo_cartao')
               field: 'sk_tipo_cartao'
    
     - name: data_venda
       description: A data de venda e chave estrangeira para dimensão de data.
       tests:
         - relationships:
             field: data_venda
             to: ref('dim_data_venda')
    
     - name: motivo_venda_fk
       description: A chave estrangeira para dimensão de motivo de venda.
       tests:
         - relationships:
             field: sk_motivo_venda
             to: ref('dim_motivo_venda')

     - name: numero_pedidos
       description: Quantidade de pedidos.
       tests: 
         - not_negative

     - name: quantidade_total_comprada
       description: Quantidade total de produtos comprados.
       tests: 
         - not_negative

     - name: valor_total_bruto
       description: Valor total dos produtos comprados (sem desconto).
       tests: 
         - not_negative

     - name: valor_total_liquido
       description: Valor líquido dos produtos comprados (com desconto).
       tests: 
         - not_negative
         - not_greater_than:
            field: valor_total_bruto
