version: 2
 
models:
 - name: fct_linhas_pedidos
   columns:
     - name: fk_localidade
       description: A chave estrengeira para a dimensão de localidade.
       tests:
         - relationships:
               to: ref('dim_localidade')
               field: 'sk_localidade'
    
     - name: fk_cliente
       description: A chave estrengeira para a dimensão de clientes.
       tests:
         - relationships:
               to: ref('dim_cliente')
               field: 'sk_cliente'
    
     - name: fk_produto
       description: A chave estrengeira para a dimensão de produto.
       tests:
         - relationships:
               to: ref('dim_produto')
               field: 'sk_produto'
    
     - name: fk_cartao
       description: A chave estrengeira para a dimensão de cartao.
       tests:
         - relationships:
               to: ref('dim_cartao')
               field: 'sk_cartao'
    
     - name: data_venda
       description: A data de venda e chave estrangeira para dimensão de data.
       tests:
         - relationships:
             field: data_venda
             to: ref('dim_data_venda')
    
     - name: id_venda
       description: Identificados do pedido (dimensão degenerada).

     - name: quantidade_comprada
       description: Quantidade total de produtos comprados.
       tests: 
         - not_negative

     - name: vendas_brutas
       description: Valor total dos produtos comprados (sem desconto).
       tests: 
         - not_negative

     - name: vendas_liquidas
       description: Valor líquido dos produtos comprados (com desconto).
       tests: 
         - not_negative
         - not_greater_than:
            field: vendas_brutas
